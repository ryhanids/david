<!doctype html>
<html lang="id">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Masaxmas — david D ongkes</title>
  <style>
    body {font-family:system-ui,Segoe UI,Arial;background:#f3f4f6;padding:24px}
    .card {background:#fff;padding:18px;border-radius:8px;box-shadow:0 4px 12px rgba(0,0,0,.06);max-width:720px;margin:16px auto}
    button {padding:10px 14px;border-radius:8px;border:none;background:#4f46e5;color:#fff;cursor:pointer}
    button:disabled {opacity:0.6;cursor:not-allowed}
    pre {background:#0b1220;color:#e6eef8;padding:12px;border-radius:6px;overflow:auto}
    #inbox {margin-top:16px;}
  </style>
</head>
<body>
  <div class="card">
    <h2>Masaxmas — Temporary Email</h2>
    <p>Buat email sementara dan lihat inbox.</p>
    <button id="btnGen">Generate Email</button>

    <div id="emailArea" style="margin-top:12px;display:none;">
      <p><strong>Email:</strong> <span id="emailText"></span></p>
      <button id="btnPoll">Cek Inbox</button>
    </div>

    <h3>Inbox</h3>
    <div id="inbox">Belum ada email.</div>
  </div>

<script>
  // Pakai backend kamu di rumahweb
  const backend = "https://5278183.my.id/proxy.php";

  document.getElementById("btnGen").addEventListener("click", async () => {
    const btn = document.getElementById("btnGen");
    btn.disabled = true; btn.textContent = "Generating...";
    try {
      const r = await fetch(backend + "?endpoint=/generate", { method: "GET" });
      const j = await r.json();
      if (j.error) return alert(j.error);

      document.getElementById("emailText").textContent = j.email;
      document.getElementById("emailArea").style.display = "block";
    } catch (e) {
      alert("Gagal generate email");
      console.error(e);
    } finally {
      btn.disabled = false; btn.textContent = "Generate Email";
    }
  });

  document.getElementById("btnPoll").addEventListener("click", async () => {
    const email = document.getElementById("emailText").textContent;
    if (!email) return alert("Belum ada email");

    try {
      const res = await fetch(backend + "?endpoint=/inbox&email=" + encodeURIComponent(email));
      const data = await res.json();
      document.getElementById("inbox").innerHTML = `<pre>${JSON.stringify(data, null, 2)}</pre>`;
    } catch (e) {
      alert("Gagal fetch inbox");
      console.error(e);
    }
  });
</script>
</body>
</html>
